/**	Briefcase.js * author: Lily Madar * created: 7 Sept 2014 * source: https://github.com/Lily2point0/briefcasejs **/!function(){function e(e,t){var r="https://spreadsheets.google.com/feeds/list/"+e.id+"/"+e.sheetNumber+"/public/values?alt=json";n(r,t)}function t(e){return Object.keys(c).forEach(function(t){e.hasOwnProperty(t)&&(c[t]=e[t])}),console.log(c),c}function n(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState)if(200==n.status)r(JSON.parse(n.responseText),i,t);else{var e=document.createElement("div");e.innerHTML=n.responseText;var s={responseType:"error",responseStatus:n.status,responseMessage:e.innerText};r(s,"error",t)}},n.open("GET",e,!0),n.send()}function r(e,t,n){var r=e;switch(t){case"raw":n(r),c.download&&a(r,"application/json");break;case"json":n(s(r.feed.entry));break;case"csv":n(o(r.feed.entry));break;case"error":n(e);break;default:n(r.feed.entry)}}function s(e){for(var t=[],n=0;n<e.length;n++){var r=[],s="";Object.keys(e[n]).forEach(function(o){if("gsx$"==o.toString().substring(0,4)){var a={},i={},u=o.toString().substring(4,o.toString().length),l=e[n][o].$t;"form"==c.type?u==c.leftColumnTitle?(a.title=l,t.push(a)):"timestamp"!=u?(i.name=u.toString(),i.value=l,r.push(i)):s=l:u==c.leftColumnTitle?(a.title=l,t.push(a)):(i.name=u.toString(),i.value=l,r.push(i))}}),t[n].categories=r,"form"==c.type&&c.showTimeStamp&&(t[n].timestamp=s)}return c.download&&a(t,"application/json"),t}function o(e){for(var t=[],n=0;n<e.length;n++){var r=[],s=[];Object.keys(e[n]).forEach(function(t){if("gsx$"==t.toString().substring(0,4)){var o=t.toString().substring(4,t.toString().length),a=e[n][t].$t;"form"!=c.type||c.showTimeStamp?(r.push(o),s.push(a)):"timestamp"!=o&&(r.push(o),s.push(a))}}),t.push(s)}t.splice(0,0,r);for(var o=[],i=0;i<t.length;i++)o.push(t[i].join(","));var u=o.join("\n");return c.download&&a(u,"text/csv"),u}function a(e,t){var n,r;"json"==i||"raw"==i?(n=[JSON.stringify(e,null,"	")],r="json"):(n=[e],r="csv");var s=new Blob(n,{type:t}),o=window.URL.createObjectURL(s),a=document.createElement("a");a.setAttribute("href",o),a.setAttribute("download","briefcaseData."+r),a.click()}var i,u={version:"1.0.0",getRawJSON:function(n,r){i="raw",e(t(n),r)},getJSON:function(n,r){i="json",e(t(n),r)},getCSV:function(n,r){i="csv",e(t(n),r)}},c={id:"",type:"spreadsheet",sheetNumber:1,leftColumnTitle:"item",showTimeStamp:!1,download:!1};this.briefcase=u}();